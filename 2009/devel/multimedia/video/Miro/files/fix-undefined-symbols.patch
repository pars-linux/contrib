--- platform/gtk-x11/setup.py~	2009-07-10 00:17:43.000000000 +0300
+++ platform/gtk-x11/setup.py	2009-07-10 00:17:44.000000000 +0300
@@ -407,7 +407,7 @@
     if is_x64():
         extra_compile_args.append("-DAMD64")
 
-    libraries = ['z', 'pthread', 'ssl']
+    libraries = ['z', 'pthread', 'ssl', 'rt']
 
     # get mt or non-mt versions of the boost libraries
     libraries += [mt_or_not("boost_python"),
@@ -617,6 +617,9 @@
 xine_options = parse_pkg_config('pkg-config',
         'libxine pygtk-2.0 gtk+-2.0 glib-2.0 gthread-2.0')
 
+# Link xine.so with -lX11 to fix undefined symbol
+xine_options['libraries'].append(('X11'))
+
 # If you get XINE crashes, uncommenting this might fix it. It's
 # necessary on Debian Etch and Ubuntu Feisty right now.
 #
--- platform/gtk-x11/setup.py~	2009-07-10 01:59:11.000000000 +0300
+++ platform/gtk-x11/setup.py	2009-07-10 01:59:12.000000000 +0300
@@ -315,7 +315,7 @@
     print "Using %s" % BOOST_LIB
 
 def compile_xine_extractor():
-    rv = os.system("gcc %s -o %s `pkg-config --libs --cflags gdk-pixbuf-2.0 glib-2.0 libxine`" %
+    rv = os.system("gcc %s -Wl,--as-needed `pkg-config --libs --cflags gdk-pixbuf-2.0 glib-2.0 libxine` -o %s" %
                    (os.path.join(platform_dir, "xine/xine_extractor.c"), os.path.join(platform_dir, "xine/xine_extractor")))
     if rv != 0:
         raise RuntimeError("xine_extractor compilation failed.  Possibly missing libxine, gdk-pixbuf-2.0, or glib-2.0.")
