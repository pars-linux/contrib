2008-10-26
* modify patch for CVE-2005-2929 to prompt user before executing command via
  a lynxcgi link even in advanced mode, as the actual URL may not be shown but
  hidden behind an HTTP redirect
* set TRUSTED_LYNXCGI:none in lynx.cfg to disable all lynxcgi URLs by default
  [CVE-2008-4690]

diff -pruN lynx2-8-5.orig/lynx.cfg lynx2-8-5/lynx.cfg
--- lynx2-8-5.orig/lynx.cfg	2008-10-26 10:40:43.000000000 +0100
+++ lynx2-8-5/lynx.cfg	2008-10-26 10:46:25.000000000 +0100
@@ -1026,7 +1026,7 @@ LOCALE_CHARSET:TRUE
 # ====
 # Do not define this.
 #
-#TRUSTED_LYNXCGI:none
+TRUSTED_LYNXCGI:none
 
 
 .h2 LYNXCGI_ENVIRONMENT
diff -pruN lynx2-8-5.orig/src/LYCgi.c lynx2-8-5/src/LYCgi.c
--- lynx2-8-5.orig/src/LYCgi.c	2008-10-26 10:40:43.000000000 +0100
+++ lynx2-8-5/src/LYCgi.c	2008-10-26 10:42:46.000000000 +0100
@@ -156,7 +156,7 @@ static BOOL can_exec_cgi(const char *lin
     if (!exec_ok(HTLoadedDocumentURL(), linktext, CGI_PATH)) {
 	/* exec_ok gives out msg. */
 	result = FALSE;
-    } else if (user_mode < ADVANCED_MODE) {
+    } else {
 	StrAllocCopy(command, linktext);
 	if (non_empty(linkargs)) {
 	    HTSprintf(&command, " %s", linkargs);
